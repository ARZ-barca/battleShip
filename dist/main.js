!function(){"use strict";function t(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function n(n){for(var r=1;r<arguments.length;r++){var i=null!=arguments[r]?arguments[r]:{};r%2?t(Object(i),!0).forEach((function(t){e(n,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach((function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(i,t))}))}return n}function e(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function r(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function i(t,n,e){var r=String(t).split(","),i=[];if("x"===e)for(var o=r[0],a=r[1],c=0;c<n;c++)i.push([+o,+a+c]);else if("y"===e)for(var u=r[0],s=r[1],l=0;l<n;l++)i.push([+u+l,+s]);return i}var o=function(t,e,o){var a,c={positions:{},createPos:t,axis:o,len:e},u=function(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return r(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?r(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,u=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return c=t.done,t},e:function(t){u=!0,a=t},f:function(){try{c||null==e.return||e.return()}finally{if(u)throw a}}}}(i(t,e,o));try{for(u.s();!(a=u.n()).done;){var s=a.value;c.positions[String(s)]="good"}}catch(t){u.e(t)}finally{u.f()}return n(n({get positions(){return c.positions},get len(){return c.len},get axis(){return c.axis},get createPos(){return c.createPos}},function(t){return{isSunk:function(){return Object.values(t.positions).every((function(t){return"hit"===t}))}}}(c)),function(t){return{getHit:function(n){t.positions[String(n)]="hit"}}}(c))};function a(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function c(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?a(Object(e),!0).forEach((function(n){u(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):a(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function u(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function s(t,n){var e="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!e){if(Array.isArray(t)||(e=function(t,n){if(t){if("string"==typeof t)return l(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?l(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){e&&(t=e);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,c=!1;return{s:function(){e=e.call(t)},n:function(){var t=e.next();return a=t.done,t},e:function(t){c=!0,o=t},f:function(){try{a||null==e.return||e.return()}finally{if(c)throw o}}}}function l(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function f(t,n,e){n.forEach((function(n){t.positions[String(n)]=e}))}function d(t,n){var e=Object.keys(n.positions),r=[];return e.forEach((function(n){for(var e=n.split(","),i=-1;i<2;i+=1)for(var o=-1;o<2;o+=1){var a=String([+e[0]+i,+e[1]+o]);"empty"!==t.positions[a]&&"unavailable"!==t.positions[a]||r.includes(a)||r.push(a)}})),r}function p(t,n,e,r){var i=o(n,e,r);return f(t,Object.keys(i.positions),"ship"),f(t,d(t,i),"unavailable"),t.ships.push(i),i}function v(t,n){var e=t.ships.indexOf(n);t.ships.splice(e,1);var r=d(t,n).filter((function(n){var e=!0;return t.ships.forEach((function(r){d(t,r).includes(String(n))&&(e=!1)})),e}));f(t,r,"empty");var i=Object.keys(n.positions);f(t,i,"empty")}function g(t,n,e,r){var o,a=s(i(n,e,r));try{for(a.s();!(o=a.n()).done;){var c=o.value;if("empty"!==t.positions[String(c)])return!1}}catch(t){a.e(t)}finally{a.f()}return!0}function h(t,n){var e,r=s(t.ships);try{for(r.s();!(e=r.n()).done;){var i=e.value;if(Object.keys(i.positions).includes(String(n)))return i}}catch(t){r.e(t)}finally{r.f()}}function m(t,n){for(var e=Object.keys(t.positions);;){var r=e[Math.floor(e.length*Math.random())],i=Math.floor(100*Math.random())%2==0?"x":"y";if(g(t,r,n,i))return o(r,n,i);var a="x"===i?"y":"x";if(g(t,r,n,a))return o(r,n,a);if(e.splice(e.indexOf(r),1),0===e.length)throw new Error("board is not big enough for this many ships")}}var y=function(t){for(var n={positions:{},ships:[],gameBoardLen:t},e=0;e<t;e++)for(var r=0;r<t;r++)n.positions[String([e,r])]="empty";return c(c(c(c(c(c(c(c(c(c({get positions(){return n.positions},get ships(){return n.ships}},function(t){return{createShip:function(n,e,r){return p(t,n,e,r)}}}(n)),function(t){return{removeShip:function(n){v(t,n)}}}(n)),function(t){return{checkPlacement:function(n,e,r){return g(t,n,e,r)}}}(n)),function(t){return{getHitShip:function(n){return h(t,n)}}}(n)),function(t){return{getHit:function(n){return function(t,n){var e=h(t,n);e&&e.getHit(n)}(t,n)}}}(n)),function(t){return{isGameOver:function(){return function(t){var n=!0;return t.ships.forEach((function(t){t.isSunk()||(n=!1)})),n}(t)}}}(n)),function(t){return{clear:function(){!function(t){for(var n=t.ships.length,e=0;e<n;e++)v(t,t.ships[0])}(t)}}}(n)),function(t){return{getRandomShip:function(n){return m(t,n)}}}(n)),function(t){return{randomize:function(n){!function(t,n){var e,r=s(n);try{for(r.s();!(e=r.n()).done;){var i=m(t,e.value);p(t,i.createPos,i.len,i.axis)}}catch(t){r.e(t)}finally{r.f()}}(t,n)}}}(n)),function(t){return{getPositionsAroundShip:function(n){return d(t,n)}}}(n))};function b(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,r)}return e}function S(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?b(Object(e),!0).forEach((function(n){O(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):b(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function O(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var j=[];function w(){for(var t={gameBoard:y(10),gameBoardLen:10,availableShots:[]},n=0;n<10;n++)for(var e=0;e<10;e++)t.availableShots.push(String([n,e]));return S({get state(){return t},get gameBoard(){return t.gameBoard},get gameBoardLen(){return t.gameBoardLen},get availableShots(){return t.availableShots}},{attack:function(t,n){return function(t,n,e){n.gameBoard.getHit(e)}(0,t,n)}})}function P(){var t=w(),n=t.state;return S(S(S({},t),function(t){return{getAttackPosition:function(){return function(t){if(0===j.length)return n=t.availableShots,e=n.length,n[Math.floor(Math.random()*e)];var n,e,r=j[0];return j.splice(0,1),r}(t)}}}(n)),function(t){return{attack:function(n,e){return function(t,n,e){var r=t.availableShots.indexOf(String(e));-1!==r&&t.availableShots.splice(r,1),n.gameBoard.getHit(e);var i=n.gameBoard.getHitShip(e);if(i)if(i.isSunk())j=[],n.gameBoard.getPositionsAroundShip(i).forEach((function(n){var e=t.availableShots.indexOf(String(n));-1!==e&&t.availableShots.splice(e,1)}));else{j=j.concat(function(t,n){for(var e=[],r=String(n).split(","),i=0,o=[1,-1];i<o.length;i++){var a=o[i];-1!==t.indexOf(String([+r[0]+a,r[1]]))&&e.push(String([+r[0]+a,r[1]])),-1!==t.indexOf(String([+r[0],+r[1]+a]))&&e.push(String([+r[0],+r[1]+a]))}return e}(t.availableShots,e));var o=function(t,n){var e=String(t).split(","),r=n.getHitShip(t);return"hit"===r.positions[String([+e[0]+1,e[1]])]||"hit"===r.positions[String([+e[0]-1,e[1]])]?[String([+e[0],+e[1]+1]),String([+e[0],+e[1]-1]),String([+e[0]+1,+e[1]+1]),String([+e[0]+1,+e[1]-1]),String([+e[0]-1,+e[1]+1]),String([+e[0]-1,+e[1]-1])]:"hit"===r.positions[String([+e[0],+e[1]+1])]||"hit"===r.positions[String([+e[0],+e[1]-1])]?[String([+e[0]+1,+e[1]]),String([+e[0]-1,+e[1]]),String([+e[0]+1,+e[1]+1]),String([+e[0]-1,+e[1]+1]),String([+e[0]+1,+e[1]-1]),String([+e[0]-1,+e[1]-1])]:void 0}(e,n.gameBoard);void 0!==o&&o.forEach((function(t){-1!==j.indexOf(t)&&j.splice(j.indexOf(t),1)}))}}(t,n,e)}}}(n))}var E=w;function A(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function k(){for(var t=document.createElement("div"),n=0;n<10;n++)for(var e=0;e<10;e++){var r=document.createElement("div");r.setAttribute("data-row",n),r.setAttribute("data-column",e),t.appendChild(r)}return t.classList.add("board"),t}function L(t,n,e){Object.keys(t.positions).forEach((function(t){var r=t.split(","),i='*[data-row="'.concat(r[0],'"][data-column="').concat(r[1],'"]');n.querySelector(i).classList.add(e)}))}function x(t,n,e){Object.keys(t.positions).forEach((function(t){var r=t.split(","),i='*[data-row="'.concat(r[0],'"][data-column="').concat(r[1],'"]');n.querySelector(i).classList.remove(e)}))}var B,C="ship",H="selected";function M(){B=void 0}function D(){return B}var I=function(t,n,e,r,i){t.attack(n,e);var o=n.gameBoard.getHitShip(e);o?(r.classList.add("hit"),o.isSunk()&&L(o,i,"sunk")):r.classList.add("miss")};function T(t){return function(t){if(Array.isArray(t))return q(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return q(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?q(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}var z=[4,3,3,2,2,2,1,1,1,1];function U(t){var n=k(),e=E(),r=document.createElement("div");r.classList.add("board-container"),r.appendChild(n);var i=document.createElement("button");i.textContent="random",i.classList.add("random");var o=document.createElement("button");o.textContent="start",o.classList.add("start");var a=document.createElement("div");a.classList.add("button-container"),a.appendChild(i),a.appendChild(o);var c=document.createElement("ol");c.classList.add("rules"),c.innerHTML="\n    <li>select a ship by clicking on it</li>\n    <li>change ship axis by clicking on it again</li>\n    <li>move ship by clicking on an empty spot</li>\n    <li>you can't place ships next to each other</li>\n  ",t.appendChild(r),t.appendChild(c),t.appendChild(a),e.gameBoard.randomize(z),e.gameBoard.ships.forEach((function(t){L(t,n,"ship")})),i.addEventListener("click",(function(){var t;(t=n.children,function(t){if(Array.isArray(t))return A(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return A(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?A(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).forEach((function(t){t.className=""})),e.gameBoard.clear(),e.gameBoard.randomize(z),e.gameBoard.ships.forEach((function(t){L(t,n,"ship")})),M()})),T(n.children).forEach((function(t){t.addEventListener("click",(function(t){return function(t,n,e){var r=[t.getAttribute("data-row"),t.getAttribute("data-column")];if(!B){if(!t.className.includes(C))return;return B=n.getHitShip(r),n.removeShip(B),void L(B,e,H)}if(t.className.includes(C)){if(Object.keys(B.positions).includes(String(r))){var i="x"===B.axis?"y":"x";return void(n.checkPlacement(B.createPos,B.len,i)&&(x(B,e,H),x(B,e,C),L(n.createShip(B.createPos,B.len,i),e,C),M()))}return x(B,e,H),n.createShip(B.createPos,B.len,B.axis),B=n.getHitShip(r),n.removeShip(B),void L(B,e,H)}n.checkPlacement(r,B.len,B.axis)&&(x(B,e,H),x(B,e,C),L(n.createShip(r,B.len,B.axis),e,C),M())}(t.target,e.gameBoard,n)}))})),o.addEventListener("click",(function(){var i=P(),o=k();i.gameBoard.randomize(z),i.gameBoard.ships.forEach((function(t){L(t,o,"ship")})),t.innerHTML="";var a=D();a&&(x(a,n,"selected"),e.gameBoard.createShip(a.createPos,a.len,a.axis)),n.classList.add("player"),o.classList.add("ai"),r.appendChild(n),r.appendChild(o),t.appendChild(r);var c=document.createElement("div");c.classList.add("guid-container"),c.innerHTML='\n        <div class="miss-guid guid">miss</div>\n        <div class="hit-guid guid">hit</div>\n        <div class="sunk-guid guid">sunk</div>\n    ',t.appendChild(c),T(o.children).forEach((function(r){r.addEventListener("click",(function(r){var a=[r.target.getAttribute("data-row"),r.target.getAttribute("data-column")];if(I(e,i,a,r.target,o),i.gameBoard.isGameOver())n.classList.add("over"),o.classList.add("over"),$("you",t);else{var c=i.getAttackPosition().split(","),u='*[data-row="'.concat(c[0],'"][data-column="').concat(c[1],'"]'),s=n.querySelector(u);I(i,e,c,s,n),e.gameBoard.isGameOver()&&(n.classList.add("over"),o.classList.add("over"),$("ai",t))}}))}))}))}function $(t,n){var e=document.createElement("div");e.classList.add("game-over");var r=document.createElement("p");r.textContent="".concat(t," won"),r.classList.add("winner-text");var i=document.createElement("button");i.textContent="Play Again",i.classList.add("play-again"),e.appendChild(r),e.appendChild(i),i.addEventListener("click",(function(){n.innerHTML="",U(n)})),n.appendChild(e)}U(document.querySelector("main"))}();